<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hora, Fecha y Clima</title>

    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #000;
        font-family: Arial, sans-serif;
      }

      video#fondo {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
      }

      .container {
        position: relative;
        width: 641px;
        height: 192px;
      }

      /* HORA */
      .time {
        position: absolute;
        top: 27%;
        left: 24%;
        transform: translate(-50%, -50%);
        font-size: 62px;
        font-weight: bold;
        color: #ffffff;
      }

      /* FECHA */
      .date {
        position: absolute;
        top: 71%;
        left: 24%;
        transform: translate(-50%, -50%);
        font-size: 33px;
        font-weight: bold;
        color: #4a90e2;
        text-align: center;
        line-height: 1.1;
      }

      /* ICONO GRANDE */
      .weather-icon-big {
        position: absolute;
        top: 50%;
        left: 57%;
        transform: translate(-50%, -50%);
        width: 90px;
        height: 90px;
      }

      /* TEMPERATURA */
      .weather {
        position: absolute;
        top: 49%;
        left: 76%;
        transform: translate(-50%, -50%);
        font-size: 57px;
        font-weight: bold;
        color: #000000;
      }

      /* DESCRIPCIÓN */
      .weather-description {
        position: absolute;
        top: 69%;
        left: 77%;
        transform: translate(-50%, -50%);
        font-size: 17px;
        color: #4a90e2;
      }

      /* CIUDAD */
      .city {
        position: absolute;
        top: 29%;
        left: 77%;
        transform: translate(-50%, -50%);
        font-size: 18px;
        font-weight: semibold;
        color: #6b6f75;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <video autoplay muted loop id="fondo">
        <source id="videoSource" src="CLIMATM_DIA.mp4" type="video/mp4" />
      </video>

      <div id="clock" class="time"></div>
      <div id="date" class="date"></div>

      <img id="weatherIconBig" class="weather-icon-big" src="Iconos/Soleado.svg" alt="clima" />
      <div class="city">Bogotá D.C</div>
      <div id="weather" class="weather"></div>
      <div id="weatherText" class="weather-description"></div>
    </div>

    <script>
      /* ========================
   RELOJ Y FECHA
======================== */
      function updateClock() {
        const now = new Date();
        const hours = String(now.getHours()).padStart(2, "0");
        const minutes = String(now.getMinutes()).padStart(2, "0");
        document.getElementById("clock").textContent = `${hours}:${minutes}`;

        const days = ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"];
        const months = [
          "Enero",
          "Febrero",
          "Marzo",
          "Abril",
          "Mayo",
          "Junio",
          "Julio",
          "Agosto",
          "Septiembre",
          "Octubre",
          "Noviembre",
          "Diciembre"
        ];

        const dayName = days[now.getDay()];
        const day = now.getDate();
        const month = months[now.getMonth()];

        document.getElementById("date").innerHTML = `${dayName}<br>${day} de ${month}`;
      }

      /* ========================
   CAMBIO VIDEO DÍA / NOCHE
======================== */
      function updateBackgroundVideo() {
        const now = new Date();
        const hour = now.getHours();
        const video = document.getElementById("fondo");
        const source = document.getElementById("videoSource");

        let newSrc;

        if (hour >= 18 || hour < 6) {
          newSrc = "CLIMATM_NOCHE.mp4";
        } else {
          newSrc = "CLIMATM_DIA.mp4";
        }

        if (source.getAttribute("src") !== newSrc) {
          source.setAttribute("src", newSrc);
          video.load();
          video.play();
        }
      }

      /* ========================
   ICONOS PERSONALIZADOS
======================== */
   function getWeatherIcon(description, iconCode) {
  const desc = description.toLowerCase();
  const isNight = iconCode.includes("n");

  // TORMENTA
  if (desc.includes("tormenta")) {
    return "Iconos/Tormenta.svg";
  }

  // LLUVIA O LLOVIZNA
  if (desc.includes("lluvia") || desc.includes("llovizna")) {
    if (desc.includes("fuerte") || desc.includes("intensa")) {
      return "Iconos/Lluvia_Fuerte.svg";
    }
    return "Iconos/Lluvia_Suave.svg";
  }

  // NUBLADO
  if (desc.includes("nube") || desc.includes("nuboso")) {
    if (desc.includes("parcial")) {
      return isNight
        ? "Iconos/Parcialmente_Nublado_Noche.svg"
        : "Iconos/Parcialmente_Nublado.svg";
    }
    return "Iconos/Nublado.svg";
  }

  // DESPEJADO
  if (desc.includes("claro") || desc.includes("despejado")) {
    return isNight
      ? "Iconos/Despejado_Noche.svg"
      : "Iconos/Soleado.svg";
  }

  // VIENTO
  if (desc.includes("viento")) {
    return "Iconos/Vientos_fuertes.svg";
  }

  // FALLBACK
  return isNight
    ? "Iconos/Despejado_Noche.svg"
    : "Iconos/Soleado.svg";
}
      /* ========================
   CLIMA API
======================== */
      async function fetchWeather() {
        const apiKey = "65fd2c24a1679d15f7b59502783522f7";
        const city = "Bogotá";
        const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=es`;

        try {
          const response = await fetch(url);
          const data = await response.json();

          if (data.weather && data.main) {
            const temperature = Math.round(data.main.temp);
            const description = data.weather[0].description;
            const iconCode = data.weather[0].icon;

            document.getElementById("weather").textContent = `${temperature}°C`;
            document.getElementById("weatherText").textContent =
              description.charAt(0).toUpperCase() + description.slice(1);

            const iconPath = getWeatherIcon(description, iconCode);
            document.getElementById("weatherIconBig").src = iconPath;
          }
        } catch (error) {
          document.getElementById("weather").textContent = "--";
          document.getElementById("weatherText").textContent = "";
        }
      }

      /* ========================
   INICIALIZACIÓN
======================== */

      updateClock();
      setInterval(updateClock, 1000);

      updateBackgroundVideo();
      setInterval(updateBackgroundVideo, 60000);

      fetchWeather();
      setInterval(fetchWeather, 10 * 60 * 1000);
    </script>
  </body>

</html>
